# Тестовое задание от Electrolux
## Формулировка

The task is to design and implement a backend service to control an appliance such as a wash machine or an oven. The API should be REST
based and the state of the appliance should be persisted to any form of persistent storage. There is no need for any frontend but we expect there
to be a README.md file with build directions and examples of how to invoke the REST API (e.g. curl).
The project should be implemented using Java or Node.js. Feel free to use any 3rd party library that you are comfortable with. Unit tests are
expected and the assignment will be assessed based on good programming practices and design.
Please use GitHub or Bitbucket to publish your source code.

##Формулировка от руководителя команды
Выбор технологий и какие именно функции вы будете внедрять полностью на вас. Только одно пожелание с нашей стороны не отягощать решение различными вариантами хранения объектов.  Используйте пожалуйста только in memory хранение объектов. 


## Описание решения
(прошу прощения что по-русски, но уже поздно и хочется спать)
1. Принял решение сделать сервис, позволяющий регистрировать кастомные приборы. Исходил из такой концепции, что есть бэкенд с известным адресом, на котором могут регистрироваться все девайсы (стиралки, кофеварки и т.п.) по известному протоколу, а именно, они должны отправить запрос типа:

curl -XPOST "host:8080/device/register" -H "Content-Type: application/json" --data '{"fields":{"turnedOn":"BOOL", "coffeeStrength": DOUBLE}, "commands": {"setTurnOn": {"value": DOUBLE}}}'

в этом случае регистрируется некий девайс, у которого есть ряд присущих ему свойств (например наличие кофейных зерен в кофеварке и состояние вкл/выкл), а так же ряд ручек, которые можно у него дернуть, например "включить". В fields передается мапка имя-поля/тип (BOOL, DOUBLE, STRING, INT), в commands мапка имя-команды/маппка-аргументов.

Предполагается, что на стороне бэкенда реализовано представление некоторого удаленного девайса, которое может по имеющимся спецификациям показать состояние полей или вызвать какую-то функцию девайса. В данной версии это не реализовано, но достаточно отнаследоваться от класса Device и переопределить методы getRemoteValue - получение значение некоторого поля по имени и remoteCall - вызов функции устройства. 

Для примера в тестовом задании есть наследник Oven, который хранит простейшее состояние некоторой печи.

Так же (в т.ч. и для Oven) введено понятие стандартных девайсов, т.е. стандартной бытовой техники со стандартными функциями и свойствами. Как например Oven, который можно просто включить-выключить и нагреть до нужной температуры (в этом игровом примере нагревание мгновенно). 

Для стандартных девайсов можно регистрировать устройства вот в таком виде:
curl -XPOST "host:8080/device/register?device_type=OVEN"

Соответственно для "полноценной" реализации не хватает протокола общения с реальными девайсами-клиентами.

В случае, если хочется сделать какой-то набор дефолтных девайсов, то можно наследоваться от Device и использовать аннотации ModelParameter (для поля состояния устройства) и ModelMethod для вызываемой функции. По данным аннотациям будут генерироваться спеки девайсов. (к сожалению не смог быстро избавиться от необходимости вставлять @IgnoreJson, а хотелось бы)

2. Получить список всех зарегистрированных устройств можно вот так:
curl -XGET "host:8080/device"

по результату будет получен json, который содержит список всех устройств, их id и спеки, содержащие списки полей и функций с параметрами.

3. Получить состояние конкретного девайса:
curl -XGET "host:8080/device/[device_id]/state" 

4. Получить спеку конкретного девайса:
curl -XGET "host:8080/device/[device_id]/description"

5. Вызвать функцию девайса:
  curl -XGET "host:8080/device/[device_id]/command/<name>?[arg_name=value&...]"
